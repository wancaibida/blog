<!DOCTYPE html>
<html lang="en">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">















  <link rel="alternate" href="/atom.xml" title="Charles' Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.10.2" />



<link rel="canonical" href="https://w2x.me/"/>



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  <link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css" />



<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.10.2" />



  


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-77440077-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-77440077-1');
</script>


  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true};
</script>

    <title> Charles' Blog </title>
  <meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Charles' Blog" type="application/atom+xml">
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Charles' Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            Home
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            Archives
          
        </li>
      </a>
    
      <a href="/tags/">
        <li class="mobile-menu-item">
          
          
            Tags
          
        </li>
      </a>
    
      <a href="/categories/">
        <li class="mobile-menu-item">
          
          
            Categories
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            About
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Charles' Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              Home
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              Archives
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            
            
              Tags
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            
            
              Categories
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              About
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <section id="posts" class="posts">
    
      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2021/12/30/Openwrt%E4%B8%ADFirewall-Custom-Rules-fwmark%E5%91%BD%E4%BB%A4%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E7%9A%84%E9%97%AE%E9%A2%98/">Openwrt中Firewall - Custom Rules fwmark命令不起作用的问题</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-12-30
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <p>路由器设置了透明代理, 但是每次重启路由器后代理就是失效了, 发现Custom Rules中<code>ip rule add fwmark 1 table 100</code> 这个命令不知道啥原因在重启后会被清除, 导致代理失败.</p>
<p>解决办法就是编辑 <code>/etc/config/network</code></p>
<p>添加以下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">config rule</span><br><span class="line">	option mark   &#39;0x1&#39;</span><br><span class="line">	option lookup &#39;100&#39;</span><br><span class="line"></span><br><span class="line">config route</span><br><span class="line">	option interface &#39;loopback&#39;</span><br><span class="line">	option target &#39;0.0.0.0&#39;</span><br><span class="line">	option netmask &#39;0.0.0.0&#39;</span><br><span class="line">	option table &#39;100&#39;</span><br><span class="line">	option type &#39;local&#39;</span><br></pre></td></tr></table></figure>

<p>代替Custom Rules的这两条命令:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ip rule add fwmark 1 table 100</span><br><span class="line">ip route add local 0.0.0.0&#x2F;0 dev lo table 100</span><br></pre></td></tr></table></figure>

<p>参考:</p>
<ul>
<li><a href="https://forum.openwrt.org/t/equivalent-of-ip-route-rule-to-be-saved-in-etc-config-network/76593" target="_blank" rel="noopener">https://forum.openwrt.org/t/equivalent-of-ip-route-rule-to-be-saved-in-etc-config-network/76593</a></li>
<li><a href="https://openwrt.org/docs/guide-user/network/ucicheatsheet#ipv4_routes" target="_blank" rel="noopener">https://openwrt.org/docs/guide-user/network/ucicheatsheet#ipv4_routes</a></li>
</ul>

        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2021/11/16/AWS-S3-Static-Website-Hosting-404/">AWS S3 Static Website Hosting 404</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-11-16
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <p>公司的前端项目是以静态化网页的方式部署在aws s3上的, 由于前端项目是用react写的,  页面的路由是前端代码控制,页面实际是不存在于s3中的, 所以每次刷新网页的时候控制台会产生一条404错误, 研究了下这个错误可以在cloudfront那里修复.</p>
<p>解决办法:<br>Cloudfront-&gt;选择项目的cdn-&gt;Error Pages-&gt;Create custom error response</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Http error code      -&gt; 404</span><br><span class="line">Custom error resonse -&gt; Yes</span><br><span class="line">Response page path   -&gt; &#x2F;index.html</span><br><span class="line">Http Response code   -&gt; 200:OK</span><br></pre></td></tr></table></figure>

<p><img src="/images/E33CB21F09C63BB1BC91833BD1A2B348.png" alt="Custom error response"></p>

        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2021/09/14/Github-Actions%E5%8A%A8%E6%80%81%E5%AF%86%E9%92%A5%E5%90%8D%E7%A7%B0/">Github Actions动态密钥名称</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-09-14
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <p><code>test.yml</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">name: LS</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">jobs:</span><br><span class="line">  deploy:</span><br><span class="line">    runs-on: ubuntu-latest</span><br><span class="line"></span><br><span class="line">    steps:</span><br><span class="line"></span><br><span class="line">    - name: Update and restart server</span><br><span class="line">      uses: appleboy&#x2F;ssh-action@v0.1.4</span><br><span class="line">      with:</span><br><span class="line">        host: $&#123;&#123; secrets[format(&#39;&#123;0&#125;_HOST&#39;, github.workflow)] &#125;&#125;</span><br><span class="line">        username: $&#123;&#123; secrets[format(&#39;&#123;0&#125;_USER&#39;, github.workflow)] &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>比如workflow的名称为<code>LS</code>, 密钥名称就为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">with:</span><br><span class="line">  host: $&#123;&#123; secrets[&#39;LS_HOST&#39;] &#125;&#125;</span><br><span class="line">  username: $&#123;&#123; secrets[&#39;LS_USER&#39;] &#125;&#125;</span><br></pre></td></tr></table></figure>
        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2021/07/29/Spring-Data-JPA%E4%BF%9D%E5%AD%98jsob%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE/">Spring Data JPA保存jsonb类型数据</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-07-29
        </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <h2 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test</span><br><span class="line">(</span><br><span class="line">    id        integer NOT NULL</span><br><span class="line">        CONSTRAINT test_pk</span><br><span class="line">            PRIMARY KEY,</span><br><span class="line">    test_data jsonb</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="定义方法"><a href="#定义方法" class="headerlink" title="定义方法"></a>定义方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Modifying</span><br><span class="line">@Query(</span><br><span class="line">    value &#x3D; &quot;INSERT INTO test (id, test_data) VALUES (:id, CAST(:testData AS JSONB))&quot;,</span><br><span class="line">    nativeQuery &#x3D; true</span><br><span class="line">)</span><br><span class="line">fun saveTest(</span><br><span class="line">    @Param(&quot;id&quot;) id: Long,</span><br><span class="line">    @Param(&quot;testData&quot;) testData: String</span><br><span class="line">): Int</span><br></pre></td></tr></table></figure>

<h2 id="调用代码"><a href="#调用代码" class="headerlink" title="调用代码"></a>调用代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val id &#x3D; 1L</span><br><span class="line">val testData &#x3D; listOf(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;)</span><br><span class="line">val testDataJsonStr &#x3D; ObjectMapper().writeValueAsString(testData)</span><br><span class="line"></span><br><span class="line">transactionTemplate.execute &#123;</span><br><span class="line">    repository.saveTest(id, testDataJsonStr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2021/06/28/Terraform-connection-ssh-private-key%E7%94%A8%E6%B3%95/">Terraform connection ssh private key用法</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-06-28
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <p>base64 encode一下private key：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~&#x2F;.ssh&#x2F;your_private_key | base64</span><br></pre></td></tr></table></figure>

<p>connection中decode一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">connection &#123;</span><br><span class="line">  type        &#x3D; &quot;ssh&quot;</span><br><span class="line">  user        &#x3D; &quot;admin&quot;</span><br><span class="line">  private_key &#x3D; base64decode(var.private_key)</span><br><span class="line">  host        &#x3D; self.public_ip_address</span><br><span class="line">  timeout     &#x3D; &quot;3600s&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2021/03/25/MIUI%E7%B3%BB%E7%BB%9F%E4%B8%8BTasker%E4%BF%9D%E6%8C%81%E5%90%8E%E5%8F%B0%E5%B8%B8%E9%A9%BB%E7%9A%84%E6%96%B9%E6%B3%95/">MIUI系统下Tasker保持后台常驻的方法</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-03-25
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <p>之前一直是用苹果的短信同步功能来同步短信的，期间老是出现一些莫名其妙不能同步短信的问题，最近实在是受不了这问题了，打算换到用android备用机来转发短信。</p>
<p>一开始用的是ifttt来同步短信的，一切运行正常，唯一的缺陷是iftt同步短信会有大概30秒左右时间的延时，有点接受不了。<br>后来开始用tasker来转发短信，尝试了下效果比ifttt好，几乎没有延时，但遇到一个问题就是tasker不能常驻后台，参考了官网的方案也没有解决这问题，研究了两天发现还有两个地方忘记了设置，在这里记录一下。</p>
<p>测试环境 MIUI 12.0.9</p>
<h2 id="MIUI设置"><a href="#MIUI设置" class="headerlink" title="MIUI设置"></a>MIUI设置</h2><h3 id="将Tasker加到白名单"><a href="#将Tasker加到白名单" class="headerlink" title="将Tasker加到白名单"></a>将Tasker加到白名单</h3><p>手机管家 -&gt; 优化加速 -&gt; 设置 -&gt; 锁定任务 -&gt; 将Tasker添加到已锁定任务</p>
<p><img src="/images/1.png" alt="1.png"><br><img src="/images/2.png" alt="2.png"><br><img src="/images/3.png" alt="3.png"><br><img src="/images/4.png" alt="4.png"></p>
<h3 id="关闭智能场景省电"><a href="#关闭智能场景省电" class="headerlink" title="关闭智能场景省电"></a>关闭智能场景省电</h3><p>手机管家 -&gt; 省电与电池 -&gt; 场景配置 -&gt; 睡眠模式 -&gt; 关闭</p>
<p><img src="/images/a.png" alt="a.png"><br><img src="/images/b.png" alt="b.png"><br><img src="/images/c.png" alt="c.png"><br><img src="/images/d.png" alt="d.png"></p>
<h2 id="其他设置"><a href="#其他设置" class="headerlink" title="其他设置"></a>其他设置</h2><ul>
<li><a href="https://tasker.joaoapps.com/userguide/en/faqs/faq-problem.html#00" target="_blank" rel="noopener">Why doesn’t Tasker work in the background on my device?</a></li>
</ul>

        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2021/03/25/Terraform-multiple-line-script-example/">Terraform multiple line script example</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-03-25
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;null_resource&quot; &quot;cluster&quot; &#123;</span><br><span class="line"></span><br><span class="line">  connection &#123;</span><br><span class="line">    type        &#x3D; &quot;ssh&quot;</span><br><span class="line">    user        &#x3D; &quot;admin&quot;</span><br><span class="line">    private_key &#x3D; base64decode(var.private_key)</span><br><span class="line">    host        &#x3D; aws_lightsail_instance.lightsail.public_ip_address</span><br><span class="line">    timeout     &#x3D; &quot;3600s&quot;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  provisioner &quot;local-exec&quot; &#123;</span><br><span class="line">    command &#x3D; &lt;&lt;EOT</span><br><span class="line">            echo &quot;&#123;\&quot;host\&quot;:\&quot;$&#123;random_string.subdomain.result&#125;\&quot;,\&quot;type\&quot;:\&quot;A\&quot;,\&quot;answer\&quot;:\&quot;$&#123;aws_lightsail_instance.lightsail.public_ip_address&#125;\&quot;,\&quot;ttl\&quot;:300&#125;&quot; | \</span><br><span class="line">            curl &quot;https:&#x2F;&#x2F;api.name.com&#x2F;v4&#x2F;domains&#x2F;$&#123;var.name_domain&#125;&#x2F;records&quot; \</span><br><span class="line">            -s \</span><br><span class="line">            -X POST \</span><br><span class="line">            -H &quot;Accept: application&#x2F;json&quot; \</span><br><span class="line">            -H &quot;Content-Type: application&#x2F;json&quot; \</span><br><span class="line">            -u &quot;$&#123;var.name_username&#125;&quot;:&quot;$&#123;var.name_token&#125;&quot; \</span><br><span class="line">            -d @-</span><br><span class="line">        EOT</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2021/02/25/Chrome%E6%B8%85%E9%99%A4DNS%E7%BC%93%E5%AD%98/">Chrome清除DNS缓存</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-02-25
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <ol>
<li>chrome://net-internals/#dns -&gt; “Clear host cache”</li>
<li>chrome://net-internals/#sockets -&gt; “Flush socket pools”</li>
</ol>

        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2020/12/27/macOS%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEPodman-2-x/">macOS安装配置Podman 2.x</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2020-12-27
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <p>macOS环境下的podman只是客户端，server端实际运行在linux环境下，所以需要安装linux虚拟机。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew install virtualbox</span><br><span class="line">brew install vagrant</span><br><span class="line">brew install podman</span><br></pre></td></tr></table></figure>

<h2 id="配置虚拟机"><a href="#配置虚拟机" class="headerlink" title="配置虚拟机"></a>配置虚拟机</h2><p>新建个文件夹，里面创建<code>Vagrantfile</code>文件，内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(&quot;2&quot;) do |config|</span><br><span class="line">  config.vm.box &#x3D; &quot;generic&#x2F;fedora32&quot;</span><br><span class="line">  config.vm.hostname &#x3D; &quot;fedora&quot;</span><br><span class="line">  config.vm.provider &quot;virtualbox&quot; do |vb|</span><br><span class="line">     vb.memory &#x3D; &quot;1024&quot;</span><br><span class="line">     vb.cpus &#x3D; 1</span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<h3 id="启动虚拟机"><a href="#启动虚拟机" class="headerlink" title="启动虚拟机"></a>启动虚拟机</h3><p>vagrant up</p>
<h3 id="配置fedora"><a href="#配置fedora" class="headerlink" title="配置fedora"></a>配置fedora</h3><p>安装podman server端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo dnf -y install podman</span><br><span class="line">systemctl --user enable --now podman.socket</span><br><span class="line">sudo loginctl enable-linger $USER</span><br><span class="line">sudo systemctl enable --now sshd</span><br></pre></td></tr></table></figure>

<p>验证安装是否成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">podman --remote info</span><br></pre></td></tr></table></figure>

<h3 id="查看虚拟机ssh配置"><a href="#查看虚拟机ssh配置" class="headerlink" title="查看虚拟机ssh配置"></a>查看虚拟机ssh配置</h3><p><code>vagrant ssh-config</code></p>
<h2 id="podman客户端配置"><a href="#podman客户端配置" class="headerlink" title="podman客户端配置"></a>podman客户端配置</h2><p>添加连接</p>
<p>podman system connection add baude –identity /Users/chen/vm/fedora/.vagrant/machines/default/virtualbox/private_key ssh://vagrant@127.0.0.1:2222/run/user/1000/podman/podman.sock</p>
<h2 id="替换docker"><a href="#替换docker" class="headerlink" title="替换docker"></a>替换docker</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias docker&#x3D;podman</span><br></pre></td></tr></table></figure>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://github.com/containers/podman/blob/master/docs/tutorials/mac_win_client.md" target="_blank" rel="noopener">Podman Remote clients for MacOS and Windows</a></li>
</ul>

        
      
    </div>

    

    

  </article>

      
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2020/12/17/%E6%9F%902ray%E7%99%BD%E5%90%8D%E5%8D%95%E8%B7%AF%E7%94%B1%E6%AD%A3%E7%A1%AE%E5%86%99%E6%B3%95/">某2ray白名单路由正确写法</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2020-12-17
        </span>
        
          <span class="post-category">
            
              <a href="/categories/linux/">linux</a>
            
          </span>
        
        
      </div>
    </header>

    
    


    <div class="post-content">
      
        
        

        
          <p>之前一直用的<a href="https://github.com/Loyalsoldier/v2ray-rules-dat" target="_blank" rel="noopener">Loyalsoldier</a>的路由规则文件，路由是这么写的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&quot;routing&quot;: &#123;</span><br><span class="line">    &quot;rules&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;field&quot;,</span><br><span class="line">            &quot;outboundTag&quot;: &quot;direct&quot;,</span><br><span class="line">            &quot;domain&quot;: [</span><br><span class="line">                &quot;geosite:private&quot;,</span><br><span class="line">                &quot;geosite:apple-cn&quot;,</span><br><span class="line">                &quot;geosite:cn&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;field&quot;,</span><br><span class="line">            &quot;outboundTag&quot;: &quot;direct&quot;,</span><br><span class="line">            &quot;ip&quot;: [</span><br><span class="line">                &quot;geoip:private&quot;,</span><br><span class="line">                &quot;geoip:cn&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最近发现<code>gstatic.com</code>域名无法访问了，研究发现<code>gstatic.com</code>域名是包含在<code>getsite:cn</code>里面的，正确写法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&quot;routing&quot;: &#123;</span><br><span class="line">  &quot;rules&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;field&quot;,</span><br><span class="line">      &quot;outboundTag&quot;: &quot;Direct&quot;,</span><br><span class="line">      &quot;domain&quot;: [</span><br><span class="line">        &quot;geosite:private&quot;,</span><br><span class="line">        &quot;geosite:tld-cn&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;field&quot;,</span><br><span class="line">      &quot;outboundTag&quot;: &quot;Proxy&quot;,</span><br><span class="line">      &quot;domain&quot;: [</span><br><span class="line">        &quot;geosite:geolocation-!cn&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;field&quot;,</span><br><span class="line">      &quot;outboundTag&quot;: &quot;Direct&quot;,</span><br><span class="line">      &quot;domain&quot;: [</span><br><span class="line">        &quot;geosite:cn&quot;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
      
    </div>

    

    

  </article>

      
      
  <nav class="pagination">
    
    
      <a class="next" href="/page/2/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


    
  </section>

          </div>
          

        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:wancaibida@gmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/wancaibida" target="_blank" rel="noopener" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>



<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2021

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">大丈夫没问题</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    


    
  



  
  





  
    <script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

  
    <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.10.2"></script>

  </body>
</html>
